[ { "title": "A Phishing Mail that stabs in the Back", "url": "/posts/a-phishing-mail-that-stabs-in-the-back/", "categories": "computer science", "tags": "storytime, computer science, reverse engineering, linux", "date": "2022-10-03 19:29:00 +0200", "snippet": "On the date of 2022-09-26, I’ve got a sus mail from someone pretending to be a professor that I know pretty well, so damn well that I know she would never send me a mail with spelling errors.For the respect of my professors and my school’s privacy, I will redact (figuratively) names, and I will also be changing name of some files.The mail had a file called: somethingImportant.zipI gues it’s the malware the attacker hoped i would open… okay, let’s open it on a VM just to make sure:extracting the file you get:$ unzip somethingImportant.zip Archive: somethingImportant.zip inflating: anHtmlFile.htmlSo the .zip-file has only one file, and it’s a .html-file.Guessing the HTML contains some unsafe javascript code, I opened it on editor instead to see it’s content, and I see:&lt;!doctype html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt;\t&lt;title&gt;Y155&lt;/title&gt;\t&lt;style type=\"text/css\"&gt;\thtml, body{\t\tfont-style: Tahoma, sans-serif;\t}\t.aopMsetisamile{\t\tfont-style: Tahoma, sans-serif;\t\tfont-size: 16px;\t}\t&lt;/style&gt;&lt;/head&gt;&lt;body&gt;\t&lt;div style=\"margin: 50px;\"&gt;\t\t&lt;h3&gt;File opening error&lt;/h3&gt;\t\t&lt;p&gt;See file &lt;b&gt;ievrmluaEt.zip&lt;/b&gt; in downloaded files&lt;/p&gt;\t\t&lt;p&gt;Password: &lt;b&gt;K789&lt;/b&gt;&lt;/p&gt; &lt;script type=\"text/javascript\"&gt;var mazeinqhsgm='bWFuLi4uIGxldCdzIHNheSBpdCdzIGEgZmlsZSwgaSdtIG5vdCBnb2luZyB0byBwdXQgdGhlIHdob2xlIGJhc2U2NCB0eHQgOi8= ... // the base64 is longer than thisso the file indeed contained some javascript code, but it seems obfuscated…But here is what i found interesting during the analysis of the malware with a friend of mine: this in js: !![] means true, so the attacker used it for a while loop:while(!![]){ try{ ... if(...) break; }catch(error){ }} you can use a function without storing it into a variable if you just want to use it once:(function(meme_template){console.log('hey sir can a get a '+meme_template+'?')})(\"BO'OH'O'WA'ER\");// output is: hey sir can a get a BO'OH'O'WA'ER? you can rotate an array with just one line:my_array = ['a', 'b', 'c', 'd']my_array['push'](my_array['shift']())// now my_array is: [ \"b\", \"c\", \"d\", \"a\" ]That’s it, that was the things that i’ve found interesting from the attacker during his JS-obfuscation:Anyhow, after the analysis with my friend, I’ve found that what this JS-does, is forcing a download of a file stored in the long b64 variable.The downloaded file is another .zip-file, that contains an .iso-file, which at the end contained a kind of Trojan. (actually i got borred, because too much reverse engineering)The most bizarre/interesting thing, is the date of reciving the mail coincided with the date of release of a video of John Hammond in which he explained how to force the download of a file in an HTML page.Here is the video:Thanks for reading!" }, { "title": "A Mojibake Experience", "url": "/posts/a-mojibake-experience/", "categories": "computer science", "tags": "storytime, computer science, linux, mojibake, meme", "date": "2022-08-29 15:24:00 +0200", "snippet": "The story began when I found a youtube video about a meme in niconico-douga (コメ付き).A video that, when I watched it, I shat myself laughing, which is the following:It’s like a YTP of Kotoura-san, but with mitary-style voice acting.What got my attention was that GYUUUUHN scream at 5:45.At that moment, I could just record the autio and end it here, BUT my brain said: NO!¯\\_(ツ)_/¯me be like: damn I wanna have the sound library with which they make these video montages… :DOne of the comments (niconico-douga comment that you find in the video, not a comment on youtube) written at the same timestamp (5:45) was: ぎゅぅぅぅぅぅぅん↓I searched on Youtube: 日本兵サウンドライブラリー (in english: sound library of japanese soldiers)then I’ve found a veeeeery long video (7 hours long, oh shit):Ouf, the list of audios in the vid is ordered, as the order of the japanese kana:as: a-i-u-e-o ka-ki-ku-ke-ko … etc.audio part found: it’s at 1:07:17 of the video, and the title of the audio is: ぎゅぅう！me be like: oh nice! the author of the video has left in the description a downloadable file :)I download … it’s zip-file with the name 日本語音声素材集2020.zip with the size of 1.8Gb(1.8Go for the frenchies :3)I unzip:unzip 日本語音声素材集2020.zip # (linux command)And here … I saw Hell… the contents of the files are certainly not corrupted, but the names of the folders and files are in “hieroglyphics”!!! BUT NOT ONLY THAT!!! the audios are also in subfolders!!! so the order is changed compared to the video…At that moment, I discovered the term “Mojibake” (文字化け).But there was a hint that helped me: when I unziped the zip-file, the extraction gave me a folder that contains everything instead of all of the subfolder directly, basically the main folder, and its name was У·Ц{МъЙ╣Р║СfН▐ПW. And taht means most likely the name of the zip-file but encoded differently (日本語音声素材集2020, but without the 2020 part).I instantly understood.So I understood that the assignment in mojibake of 日本語音声素材集 (without 2020 at the end) is У·Ц{МъЙ╣Р║СfН▐ПW.I did some research on the encoding, I found that Japanese characters are normally done in Shift_JIS encoding… noice so I have at least the destination encoding… I just need the source encoding.after a big trouble I could find that the encoding of У·Ц{МъЙ╣Р║СfН▐ПW is in IBM866.to check, I used a site that transforms the texts by changing the encodings:https://www.online-decoder.com/el/ei(sometimes, the website can give you a 502 Bad Gateway error).to check if I’m right: I took У·Ц{МъЙ╣Р║СfН▐ПW and transformed the encoding:from IBM866 to Shift_JISthe result was: 日本語音声素材集me be like: yeeeeeeeeeeahso I took this string: ぎゅぅう！.wav (yeah because all the audio in this zip have .wav as file-extention):from Shift_JIS en IBM866the result was: ВмВуВгВдБI.wavI only thing I had to do was to:find -name \"ВмВуВгВдБI.wav\" -type fand the result is:./У·Ц{МъЙ╣Р║СfН▐ПW/MoHPA/Г_ГББ[ГWБEЩЇЪK/ВмВуВгВдБI.wavI play the audio I found to check: it is the audio I was looking for!NIIIIIIIIIIIIIIIIIICE!!!!!!!!!!!" }, { "title": "Hello Content", "url": "/posts/hello-content/", "categories": "storytime", "tags": "firsttime, demonstration, touhou, reddit", "date": "2022-08-26 17:34:00 +0200", "snippet": "HelloThis is my first blog, let’s see how it’ll work out!I’m Fukuro, a computer science student, I live in Germany.I wanted to do a blog, I checked for a way to do it fast,so I discovered Jekyll.You might saw the favicon of the blog:Basically it’s a reference to Touhou (東方Project).It was the same logo i discovered in r/place" } ]
